# Neuroevolution Dodging Game

## About

## Neural Network
### Model
The neural network model used in this project consists of three layers: an input layer, which recieves gameplay information, a hidden layer, which helps in general processing and an output layer, which decides the actions that a player makes. The input layer receives four different inputs, the hidden layer has four fully connected perceptrons and the output layer gives three outputs. This neural network's diagram, without including the bias neural weights, is explained in the following image.

<p align="center">
  <img src="https://github.com/gnoya/Neuroevolution-Dodging-Game/blob/Readme/results/NeuralNetworkModel.png" width="500">
</p>


'Player.x' refers to the X-axis position of the current player. 'Block.x' and 'Block.y' refer to X-axis and Y-axis position of the player's nearest block. Also, 'Block.width' represents the width of that block.

Focusing on the output layer, three options are given: move player to the left, move player to the right or don't move at all.

### Initialization
The weights between perceptrons were initialized randomly with values between -1 and 1. The bias weights were also initialized this way.

## Genetic Algorithms
These algorithms were implemented using a population of 350 players and a 0.05 mutation probability rate. The score represented how many frames the player lasted without dying. The fitness was calculated based on the score. The genes used were the weights of each neural network.

### Fitness
Every frame that a player was alive it scored. Then, when every player had died, every score was added up into a constant, which divided every player's score resulting in its fitness. This way, the sum of all fitnesses equals to 1.

### Natural Selection
A mating pool was created based on every player's fitness, meaning that players with higher fitness will be more likely to be picked. To create a new generation of players, two parents were picked randomly from this mating pool. Afterwards, the parents' genes were crossed and the child's genes had a chance of mutation.

### Crossover
The crossover algorithm implemented 

<p align="center">
  <img src="https://github.com/gnoya/Neuroevolution-Dodging-Game/blob/Readme/results/simpleModel.png" width="500">
</p>

Blobloblop

<p align="center">
  <img src="https://github.com/gnoya/Neuroevolution-Dodging-Game/blob/Readme/results/Crossover.png" width="500">
</p>

### Mutation
Mutation consisted on tweaking a weight from the neural network. For every weight in the neural network a random number between 0 and 1 was generated. If that random number was lower than the mutation rate, that particular weight mutated and its value was added to another random number generated by a Gaussian distribution with a mean of 0 and a standard deviation of 1.
## Results

Bipbipbipbop

<p align="center">
  <img src="https://github.com/gnoya/Neuroevolution-Dodging-Game/blob/Readme/results/training.png" width="500">
</p>

Bl√±ablalbal

<p align="center">
  <img src="https://github.com/gnoya/Neuroevolution-Dodging-Game/blob/Readme/results/showingBest.png" width="500">
</p>

## Built With

[P5.js](https://github.com/processing/p5.js "P5.js library")

[Toy-Neural-Network-JS](https://github.com/CodingTrain/Toy-Neural-Network-JS "Toy Nerual Network library")
