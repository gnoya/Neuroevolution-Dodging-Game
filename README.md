# Neuroevolution Dodging Game

## About

## Neural Network
### Model
The neural network model used in this project consists of three layers: an input layer, which recieves gameplay information, a hidden layer, which helps in general processing and an output layer, which decides the actions that a player makes. The input layer receives four different inputs, the hidden layer has four fully connected perceptrons and the output layer gives three outputs. This neural network's diagram, without including the bias neural weights, can be found in the following image.

<p align="center">
  <img src="https://github.com/gnoya/Neuroevolution-Dodging-Game/blob/Readme/results/NeuralNetworkModel.png" width="500">
</p>


'Player.x' refers to the X-axis position of the current player. 'Block.x' and 'Block.y' refer to X-axis and Y-axis position of the player's nearest block. Also, 'Block.width' represents the width of that block.

Focusing on the output layer, three options are given: move player to the left, move player to the right or don't move at all.

### Initialization
The weights between perceptrons are initialized randomly with values between -1 and 1. The bias weights are also initialized this way.

## Genetic Algorithms
These algorithms were implemented using a population of 350 players and a 0.05 mutation probability rate. The score represents how many frames the player lasted without dying. The fitness is calculated based on the score. The genes used were the weights of each neural network.

### Fitness
Every frame that a player is alive it scores. Then, when every player dies, every score is added up into a constant, which divides every player's score and resulting in its fitness. This way, the sum of all fitnesses equals to 1.

### Natural Selection
A mating pool is created based on every player's fitness, meaning that players with higher fitness will be more likely to be picked. To create a new generation of players, two parents are picked randomly from this mating pool. Afterwards, the parents' genes are crossed and the child's genes could mutate.

### Crossover
The crossover algorithm implemented 

<p align="center">
  <img src="https://github.com/gnoya/Neuroevolution-Dodging-Game/blob/Readme/results/simpleModel.png" width="500">
</p>

Blobloblop

<p align="center">
  <img src="https://github.com/gnoya/Neuroevolution-Dodging-Game/blob/Readme/results/Crossover.png" width="500">
</p>

### Mutation
Mutation consists on tweaking a weight from the neural network. For every weight in the neural network a random number between 0 and 1 is picked. If that random number is lower than the mutation rate, the weight mutates and its value is added with another random number generated by a gaussian distribution with mean of 0 and a standard deviation of 1.
## Results

Bipbipbipbop

<p align="center">
  <img src="https://github.com/gnoya/Neuroevolution-Dodging-Game/blob/Readme/results/training.png" width="500">
</p>

Bl√±ablalbal

<p align="center">
  <img src="https://github.com/gnoya/Neuroevolution-Dodging-Game/blob/Readme/results/showingBest.png" width="500">
</p>

## Built With

[P5.js](https://github.com/processing/p5.js "P5.js library")

[Toy-Neural-Network-JS](https://github.com/CodingTrain/Toy-Neural-Network-JS "Toy Nerual Network library")
